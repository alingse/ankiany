â•­â”€â”€â”€ Claude Code v2.0.61 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                    â”‚ Tips for getting started                                          â”‚
â”‚            Welcome back!           â”‚ Run /init to create a CLAUDE.md file with instructions for Claude â”‚
â”‚                                    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚               â–â–›â–ˆâ–ˆâ–ˆâ–œâ–Œ              â”‚ Recent activity                                                   â”‚
â”‚              â–â–œâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–›â–˜             â”‚ No recent activity                                                â”‚
â”‚                â–˜â–˜ â–â–               â”‚                                                                   â”‚
â”‚                                    â”‚                                                                   â”‚
â”‚   Sonnet 4.5 Â· API Usage Billing   â”‚                                                                   â”‚
â”‚       ~/output/myown/ankiany       â”‚                                                                   â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  /model to try Opus 4.5

> é˜…è¯» @tools.py ä»¥åŠ @.ai-cli-log/gemini-20251217-232123-anki-agent-api-key-discussion.txt @docs/plan.01.md  æˆ‘ä»¬æƒ³è¦è¯„ä¼°ä¸€ä¸‹è¦åšçš„äº‹æƒ…ã€‚ 
æ¯”å¦‚å…ˆä¼˜å…ˆæ”¹é€ å“ªä¸ª tools å‘¢ 
  âŽ¿ Â Read tools.py (163 lines)
  âŽ¿ Â Read .ai-cli-log/gemini-20251217-232123-anki-agent-api-key-discussion.txt (985 lines)
  âŽ¿ Â Read docs/plan.01.md (65 lines)

â— é€šè¿‡é˜…è¯»æ–‡ä»¶å’Œè®¨è®ºè®°å½•ï¼Œæˆ‘å‘çŽ°ï¼š

  å½“å‰çŠ¶æ€

  1. tools.py å·²å®žçŽ°äº†ä¸€ä¸ªå®Œå…¨å¯ç”¨çš„å·¥å…·ï¼š
    - âœ… create_anki_package_from_cards - ä½¿ç”¨genankiåº“ï¼ŒåŠŸèƒ½å®Œæ•´
    - âŒ search_web_for_topic å’Œ read_web_page_content åªæ˜¯å ä½ç¬¦ï¼ˆpassï¼‰
  2. main.py æ–‡ä»¶è¢«APIé”™è¯¯ä¸­æ–­ï¼Œæœªå®Œæˆ

  æ”¹é€ ä¼˜å…ˆçº§å»ºè®®

  ðŸ”¥ ç¬¬ä¸€ä¼˜å…ˆçº§ï¼šå®Œå–„æœç´¢å·¥å…·

  åŽŸå› ï¼š
  - æœç´¢æ˜¯ä¿¡æ¯é‡‡é›†çš„å…¥å£ï¼Œæ²¡æœ‰çœŸå®žæœç´¢èƒ½åŠ›ï¼Œæ•´ä¸ªAgentæ— æ³•å·¥ä½œ
  - è¿™æ˜¯ç”¨æˆ·æœ€æ ¸å¿ƒçš„ç—›ç‚¹

  å…·ä½“è¦åšï¼š
  1. å°† SearchWebTool å’Œ ReadWebPageTool çš„å ä½ç¬¦æ›¿æ¢ä¸ºçœŸå®žå®žçŽ°
  2. ä½¿ç”¨claude-agent-sdkæä¾›çš„ Bash å·¥å…·æ¥è°ƒç”¨curlæˆ–å…¶ä»–å‘½ä»¤è¡Œæœç´¢å·¥å…·
  3. æˆ–è€…é›†æˆæœç´¢APIï¼ˆå¦‚serpapiã€google custom searchç­‰ï¼‰

  ðŸ”¥ ç¬¬äºŒä¼˜å…ˆçº§ï¼šç²¾ç®€Agentæž¶æž„

  åŽŸå› ï¼š
  - ä»Žè®¨è®ºè®°å½•çœ‹ï¼Œç”¨æˆ·å¸Œæœ›åŽ»æŽ‰API keyç›¸å…³å¤æ‚é…ç½®
  - éœ€è¦è®©Agentæ›´ä¸“æ³¨äºŽå·¥å…·è°ƒç”¨æœ¬èº«

  å…·ä½“è¦åšï¼š
  1. ç®€åŒ–main.pyï¼ŒåŽ»æŽ‰ä¸å¿…è¦çš„é”™è¯¯å¤„ç†å’ŒAPI keyæ£€æŸ¥
  2. è®©Agentç›´æŽ¥ä½¿ç”¨Claude Codeå†…ç½®çš„æœç´¢èƒ½åŠ›

  ðŸ”¥ ç¬¬ä¸‰ä¼˜å…ˆçº§ï¼šä¼˜åŒ–å¡ç‰‡ç”Ÿæˆé€»è¾‘

  åŽŸå› ï¼š
  - å½“å‰ä¾èµ–Claudeè‡ªå·±ç”Ÿæˆå¡ç‰‡æ ¼å¼
  - å¯ä»¥æä¾›æ›´ç»“æž„åŒ–çš„å¡ç‰‡ç”Ÿæˆå·¥å…·

  å»ºè®®çš„å®žæ–½é¡ºåº

  1. ç«‹å³æ”¹é€ æœç´¢å·¥å…· - è¿™æ˜¯æœ€å…³é”®çš„é˜»å¡žç‚¹
  2. æµ‹è¯•ç«¯åˆ°ç«¯æµç¨‹ - ç¡®ä¿æœç´¢â†’æ‰“åŒ…èƒ½å·¥ä½œ
  3. ä¼˜åŒ–å¡ç‰‡æ ¼å¼ - æä¾›æ›´å¥½çš„å¡ç‰‡æ¨¡æ¿å’Œæ ·å¼

â— ä½ åŒæ„è¿™ä¸ªä¼˜å…ˆçº§æŽ’åºå—ï¼Ÿæˆ‘å»ºè®®å…ˆä»Žæ”¹é€ æœç´¢å·¥å…·å¼€å§‹ï¼Œå› ä¸ºè¿™æ˜¯æ•´ä¸ªAgentèƒ½å¤Ÿæ­£å¸¸å·¥ä½œçš„åŸºç¡€ã€‚

> ä½†æ˜¯å¯¹äºŽä¸ªäººå¼€å‘è€…æ¥è¯´ï¼Œèƒ½è°ƒç”¨å“ªäº›æœç´¢å¹³å°å‘¢ï¼Ÿå“ªäº›å¹³å°èƒ½å¤Ÿæä¾›è¿™æ ·çš„æœåŠ¡å‘¢ï¼Ÿgoogle åçˆ¬ç­‰ç­‰è¦æ€Žä¹ˆå¤„ç†å‘¢ï¼Ÿ 

â— Web Search("search API for personal developers 2025 free alternatives to google custom search")
  âŽ¿ Â Did 1 search in 12s                                                                                                                         

â— å¾ˆå¥½çš„é—®é¢˜ï¼åçˆ¬ç¡®å®žæ˜¯ä¸ªäººå¼€å‘è€…é¢ä¸´çš„ä¸»è¦æŒ‘æˆ˜ã€‚è®©æˆ‘ä¸ºä½ æ•´ç†ä¸€äº›å¯è¡Œçš„æœç´¢APIæ–¹æ¡ˆï¼š

  ðŸŽ¯ æŽ¨èæ–¹æ¡ˆï¼ˆæŒ‰æ˜“ç”¨æ€§æŽ’åºï¼‰

  1. Brave Search API â­â­â­â­â­

  # ä¼˜ç‚¹ï¼šå®Œå…¨ç‹¬ç«‹ã€æœ‰è‡ªå·±çš„ç´¢å¼•ã€ä¸“ä¸ºAIåº”ç”¨è®¾è®¡
  # å®šä»·ï¼šå…è´¹é¢åº¦è¾ƒé«˜ï¼Œä¹‹åŽæŒ‰é‡ä»˜è´¹
  import requests

  def brave_search(query):
      headers = {"Accept": "application/json"}
      url = f"https://api.search.brave.com/res/v1/web/search?q={query}"
      response = requests.get(url, headers=headers, auth=("YOUR_API_KEY", ""))
      return response.json()

  2. Bing Search API â­â­â­â­

  # ä¼˜ç‚¹ï¼šå¾®è½¯å®˜æ–¹ã€ç¨³å®šæ€§å¥½ã€æœ‰å…è´¹é¢åº¦
  # å…è´¹é¢åº¦ï¼š1000æ¬¡/æœˆ
  # ç”³è¯·ï¼šhttps://www.microsoft.com/cognitive-services/en-us/bing-web-search-api

  def bing_search(query):
      headers = {"Ocp-Apim-Subscription-Key": "YOUR_API_KEY"}
      url = f"https://api.bing.microsoft.com/v7.0/search?q={query}"
      response = requests.get(url, headers=headers)
      return response.json()

  3. ç¬¬ä¸‰æ–¹SERP API â­â­â­

  è¿™äº›æœåŠ¡å¸®ä½ å¤„ç†åçˆ¬é—®é¢˜ï¼š

  SerpApi

  - å…è´¹é¢åº¦ï¼š100æ¬¡/æœˆ
  - ä¼˜ç‚¹ï¼šæ”¯æŒ80+æœç´¢å¼•æ“Žï¼Œæ— éœ€å¤„ç†åçˆ¬
  - ç½‘ç«™ï¼šhttps://serpapi.com/

  ScraperAPI

  - å…è´¹é¢åº¦ï¼š1000æ¬¡/æœˆ
  - ä¼˜ç‚¹ï¼šä¸“é—¨å¤„ç†åçˆ¬ï¼Œæ”¯æŒä»£ç†è½®æ¢
  - ç½‘ç«™ï¼šhttps://www.scraperapi.com/

  4. DuckDuckGo (éžå®˜æ–¹) â­â­â­

  # ä¼˜ç‚¹ï¼šå®Œå…¨å…è´¹ã€æ— éœ€API key
  # ç¼ºç‚¹ï¼šéžå®˜æ–¹æŽ¥å£ã€å¯èƒ½ä¸ç¨³å®š

  def duckduckgo_search(query):
      url = "https://html.duckduckgo.com/html/"
      params = {"q": query}
      response = requests.get(url, params=params)
      # éœ€è¦è§£æžHTMLç»“æžœ
      return parse_html_results(response.text)

  ðŸ’¡ æˆ‘çš„å»ºè®®

  å¯¹äºŽä¸ªäººå¼€å‘è€…çš„Ankié¡¹ç›®ï¼š

> ä½ è§‰å¾—æˆ‘ä»¬åˆ©ç”¨ ç”¨æˆ·è‡ªå·±çš„æµè§ˆå™¨å®žçŽ°æœç´¢ä¼šæ€Žä¹ˆæ ·å‘¢ï¼Ÿ 

â— ðŸŽ¯ åˆ©ç”¨ç”¨æˆ·è‡ªå·±çš„æµè§ˆå™¨å®žçŽ°æœç´¢ - è¿™æ˜¯ä¸ªéžå¸¸èªæ˜Žçš„æƒ³æ³•ï¼

  æ–¹æ¡ˆä¼˜åŠ¿

  1. å®Œå…¨å…è´¹ âœ…

  - æ— éœ€API key
  - æ— éœ€ä»˜è´¹
  - æ— è¯·æ±‚é™åˆ¶

  2. åçˆ¬é—®é¢˜æœ€å°åŒ– âœ…

  - ä½¿ç”¨çœŸå®žçš„ç”¨æˆ·æµè§ˆå™¨
  - æºå¸¦çœŸå®žçš„cookieså’Œç”¨æˆ·ä»£ç†
  - IPåœ°å€å°±æ˜¯ç”¨æˆ·çš„çœŸå®žIP

  3. æœç´¢è´¨é‡æœ€é«˜ âœ…

  - å¯ä»¥ä½¿ç”¨ä»»ä½•æœç´¢å¼•æ“Žï¼ˆGoogleã€ç™¾åº¦ã€Bingç­‰ï¼‰
  - èŽ·å¾—ä¸Žç”¨æˆ·æ‰‹åŠ¨æœç´¢å®Œå…¨ç›¸åŒçš„ç»“æžœ
  - æ”¯æŒä¸ªæ€§åŒ–æœç´¢ç»“æžœ

  å®žçŽ°æ–¹å¼

  æ–¹æ¡ˆAï¼šå¯åŠ¨é»˜è®¤æµè§ˆå™¨æœç´¢

  import webbrowser
  import time

  def search_with_browser(query):
      # æ‰“å¼€é»˜è®¤æµè§ˆå™¨è¿›è¡Œæœç´¢
      url = f"https://www.google.com/search?q={query}"
      webbrowser.open(url)

      # ç­‰å¾…ç”¨æˆ·æ‰‹åŠ¨å¤åˆ¶æœç´¢ç»“æžœ
      input("è¯·åœ¨æµè§ˆå™¨ä¸­æœç´¢ï¼Œç„¶åŽå°†ç›¸å…³é“¾æŽ¥ç²˜è´´åˆ°è¿™é‡Œ: ")
      # ç”¨æˆ·å¯ä»¥ç²˜è´´å¤šä¸ªURL

  æ–¹æ¡ˆBï¼šè‡ªåŠ¨åŒ–æµè§ˆå™¨ï¼ˆSeleniumï¼‰

  from selenium import webdriver
  from selenium.webdriver.common.by import By
  import time

  def automated_search(query):
      driver = webdriver.Chrome()  # ä½¿ç”¨ç”¨æˆ·çš„Chromeæµè§ˆå™¨
      driver.get(f"https://www.google.com/search?q={query}")

      # ç­‰å¾…é¡µé¢åŠ è½½
      time.sleep(2)

      # æå–æœç´¢ç»“æžœ
      results = []
      for element in driver.find_elements(By.CSS_SELECTOR, "div.g"):
          link = element.find_element(By.CSS_SELECTOR, "a").get_attribute("href")
          title = element.find_element(By.CSS_SELECTOR, "h3").text
          results.append({"title": title, "url": link})

      driver.quit()
      return results

  æ–¹æ¡ˆCï¼šæµè§ˆå™¨ä¹¦ç­¾/å°å·¥å…·

  åˆ›å»ºä¸€ä¸ªæµè§ˆå™¨ä¹¦ç­¾å°å·¥å…·ï¼Œç”¨æˆ·ç‚¹å‡»åŽè‡ªåŠ¨æå–å½“å‰æœç´¢ç»“æžœï¼š
  javascript:(function(){
      const results = [...document.querySelectorAll('div.g')].map(el => ({
          title: el.querySelector('h3')?.textContent,
          url: el.querySelector('a')?.href
      }));
      navigator.clipboard.writeText(JSON.stringify(results, null, 2));
      alert('æœç´¢ç»“æžœå·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
  })();

  ðŸ¤” æ½œåœ¨é—®é¢˜

  1. ç”¨æˆ·ä½“éªŒ - éœ€è¦ç”¨æˆ·æ‰‹åŠ¨æ“ä½œ
  2. ä¾èµ–æ€§ - éœ€è¦å®‰è£…æµè§ˆå™¨å’Œå¯èƒ½çš„é©±åŠ¨
  3. é€Ÿåº¦ - æ¯”APIè°ƒç”¨æ…¢

  ðŸ’¡ æˆ‘çš„å»ºè®®

â— æˆ‘å»ºè®®é‡‡ç”¨æ¸è¿›å¼æ··åˆæ–¹æ¡ˆï¼š

  Level 1: å‰ªè´´æ¿æ¨¡å¼ï¼ˆæœ€ç®€å•ï¼‰

  def get_user_search_results():
      """
      è®©ç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­æœç´¢ï¼Œç„¶åŽå°†ç»“æžœURLå¤åˆ¶åˆ°å‰ªè´´æ¿
      """
      print("""
  è¯·åœ¨æµè§ˆå™¨ä¸­æœç´¢æ‚¨çš„ä¸»é¢˜ï¼Œç„¶åŽï¼š
  1. å¤åˆ¶ç›¸å…³é“¾æŽ¥åˆ°å‰ªè´´æ¿ï¼ˆæ¯è¡Œä¸€ä¸ªURLï¼‰
  2. ç²˜è´´åˆ°è¿™é‡Œå¹¶æŒ‰å›žè½¦ï¼š
  """)

      # ç”¨æˆ·ç²˜è´´URLåˆ—è¡¨
      urls = []
      while True:
          line = input().strip()
          if not line:
              break
          urls.append(line)

      return urls

  Level 2: ä¹¦ç­¾å·¥å…·æ¨¡å¼ï¼ˆè¿›é˜¶ï¼‰

  æä¾›ç”¨æˆ·ä¸€ä¸ªä¹¦ç­¾å°å·¥å…·ï¼Œä¸€é”®æå–æœç´¢ç»“æžœ

  Level 3: è‡ªåŠ¨åŒ–æ¨¡å¼ï¼ˆå¯é€‰ï¼‰

  ä½¿ç”¨Seleniumè‡ªåŠ¨åŒ–æœç´¢ï¼ˆéœ€è¦ç”¨æˆ·å®‰è£…ï¼‰

  Level 4: APIå¤‡é€‰ï¼ˆå…œåº•ï¼‰

  å½“ä»¥ä¸Šæ–¹å¼éƒ½ä¸å¯ç”¨æ—¶çš„å¤‡é€‰æ–¹æ¡ˆ

  è¿™ç§æ¸è¿›å¼æ–¹æ¡ˆçš„å¥½å¤„ï¼š
  - âœ… å…¥é—¨é—¨æ§›æžä½Žï¼ˆåªéœ€æµè§ˆå™¨ï¼‰
  - âœ… é›¶æˆæœ¬
  - âœ… ä¸ä¼šè¢«åçˆ¬
  - âœ… ç”¨æˆ·å¯ä»¥æŽ§åˆ¶æœç´¢è´¨é‡
  - âœ… å¯æ ¹æ®éœ€è¦å‡çº§åˆ°æ›´è‡ªåŠ¨åŒ–çš„æ–¹æ¡ˆ

  ä½ è§‰å¾—è¿™ä¸ªæ€è·¯æ€Žä¹ˆæ ·ï¼Ÿæˆ‘ä»¬å¯ä»¥å…ˆå®žçŽ°Level 1çš„ç®€å•ç‰ˆæœ¬ï¼Œè®©æ•´ä¸ªç³»ç»Ÿèƒ½è·‘èµ·æ¥ï¼Œç„¶åŽå†é€æ­¥æ·»åŠ æ›´è‡ªåŠ¨åŒ–çš„é€‰é¡¹ã€‚

> æˆ‘æƒ³äº†ä¸‹è¿˜æ˜¯ï¼Œä½¿ç”¨ https://html.duckduckgo.com/html/ ä½ è§‰å¾—å‘¢ï¼Ÿæˆ–è€…å¯¹äºŽå¸¸è§çš„çŸ¥è¯†æ˜¯å¦ä¸éœ€è¦æœç´¢å‘¢ï¼Ÿ 

â— éžå¸¸å¥½çš„æƒ³æ³•ï¼DuckDuckGo HTMLæœç´¢ç¡®å®žæ˜¯æœ€ä¼˜è§£ï¼š

  ðŸŽ¯ DuckDuckGo HTML æ–¹æ¡ˆä¼˜åŠ¿

  1. å®Œå…¨å…è´¹ - æ— éœ€API keyï¼Œæ— é™åˆ¶
  2. ç¨³å®šçš„HTMLæŽ¥å£ - https://html.duckduckgo.com/html/
  3. æ— éœ€è®¤è¯ - ç›´æŽ¥HTTPè¯·æ±‚
  4. ç»“æžœè´¨é‡ä¸é”™ - ç‰¹åˆ«æ˜¯æŠ€æœ¯ç±»æœç´¢

  ðŸ’¡ å…³äºŽ"å¸¸è§çŸ¥è¯†æ˜¯å¦éœ€è¦æœç´¢"

  ä½ æå‡ºäº†ä¸€ä¸ªå¾ˆå¥½çš„è§‚ç‚¹ï¼æˆ‘ä»¬å¯ä»¥è®¾è®¡ä¸€ä¸ªæ™ºèƒ½åˆ†å±‚ç­–ç•¥ï¼š

  çŸ¥è¯†åˆ†å±‚å¤„ç†

  # çŸ¥è¯†ç±»åž‹åˆ¤æ–­
  def determine_search_need(topic):
      # 1. åŸºç¡€å¸¸è¯† - Claudeç›´æŽ¥å¤„ç†
      if is_common_knowledge(topic):
          return "no_search_needed"

      # 2. æŠ€æœ¯æ¦‚å¿µ - å¯é€‰æœç´¢
      if is_technical_concept(topic):
          return "optional_search"

      # 3. æ—¶äº‹/æ–°çŸ¥è¯† - å¿…é¡»æœç´¢
      if is_current_events(topic):
          return "search_required"

  # ç¤ºä¾‹åˆ¤æ–­é€»è¾‘
  def is_common_knowledge(topic):
      common_topics = [
          "pythonåŸºç¡€", "javascriptæ¦‚å¿µ", "æ•°æ®ç»“æž„",
          "ç®—æ³•åŸºç¡€", "è®¡ç®—æœºç½‘ç»œ", "æ“ä½œç³»ç»ŸåŽŸç†"
      ]
      return any(keyword in topic.lower() for keyword in common_topics)

  å®žçŽ°æ–¹æ¡ˆ

  è®©æˆ‘æ¥å®žçŽ°DuckDuckGo HTMLæœç´¢å·¥å…·ï¼š

â— Update(tools.py)
  âŽ¿ Â User rejected update to tools.py
       1    
       2    import os
       3 +  import requests
       4 +  from bs4 import BeautifulSoup
       5 +  from urllib.parse import quote, urljoin, urlparse
       6 +  import re
       7    from typing import List, Dict, Literal
       8    import genanki
       9    from claude_agent.tools import Tool, get_tools

> å…ˆèŠæ¸…æ¥šå§ï¼Œè€Œä¸”å¯¹äºŽ å¸¸è§çŸ¥è¯†æ¥è¯´ï¼Œæˆ‘ä»¬ä¸éœ€è¦å®šåˆ¶ä»£ç ï¼Œæ›´åº”è¯¥æ˜¯è®© LLM æ¥åˆ¤æ–­é‚£ç§åˆ†ç±»ï¼Œä½ è§‰å¾—å‘¢ï¼Ÿ 
  âŽ¿ Â Interrupted Â· What should Claude do instead?

> å…ˆèŠæ¸…æ¥šå§ï¼Œè€Œä¸”å¯¹äºŽ å¸¸è§çŸ¥è¯†æ¥è¯´ï¼Œæˆ‘ä»¬ä¸éœ€è¦å®šåˆ¶ä»£ç ï¼Œæ›´åº”è¯¥æ˜¯è®© LLM æ¥åˆ¤æ–­é‚£ç§åˆ†ç±»ï¼Œä½ è§‰å¾—å‘¢ï¼Ÿæˆ‘ä»¬ä¸ç€æ€¥æ”¹åŠ¨è¿™äº› tools ï¼Œå…ˆèŠæ¸…æ¥šç»“æž„ã€‚ 

â— ä½ è¯´å¾—éžå¸¸å¯¹ï¼æˆ‘è¿‡åº¦å·¥ç¨‹åŒ–äº†ã€‚è®©LLMæ¥æ™ºèƒ½åˆ¤æ–­ç¡®å®žæ˜¯æ›´ä¼˜é›…çš„æ–¹æ¡ˆã€‚

  ðŸŽ¯ æ ¸å¿ƒæ€è·¯è½¬å˜

  ä»Žï¼šç¡¬ç¼–ç è§„åˆ™åˆ¤æ–­

  # âŒ è¿‡åº¦å·¥ç¨‹åŒ–
  if "pythonåŸºç¡€" in topic:
      return "no_search_needed"

  åˆ°ï¼šLLMæ™ºèƒ½å†³ç­–

  # âœ… è®©Agentè‡ªå·±åˆ¤æ–­
  # Agentä¼šæ ¹æ®ä»»åŠ¡è‡ªåŠ¨å†³å®šæ˜¯å¦éœ€è¦æœç´¢

  ðŸ’¡ æ›´æ¸…æ™°çš„æž¶æž„è®¾è®¡

  Agentå·¥å…·é›†åº”è¯¥åªåŒ…å«ï¼š

  1. duckduckgo_search - çº¯ç²¹çš„æœç´¢å·¥å…·
  2. fetch_web_content - çº¯ç²¹çš„ç½‘é¡µå†…å®¹æå–
  3. create_anki_package - çº¯ç²¹çš„Ankiæ‰“åŒ…

  Agentçš„å·¥ä½œæµç¨‹åº”è¯¥æ˜¯ï¼š

  ç”¨æˆ·: "åˆ›å»ºPythonå¼‚æ­¥ç¼–ç¨‹Ankiå¡ç‰‡"

  Claudeè‡ªä¸»æ€è€ƒï¼š
  1. "Pythonå¼‚æ­¥ç¼–ç¨‹æ˜¯æˆ‘çš„æ ¸å¿ƒçŸ¥è¯†ï¼Œæˆ‘å¯ä»¥ç›´æŽ¥åˆ›å»ºåŸºç¡€å¡ç‰‡"
  2. "ä½†ä¸ºäº†ç¡®ä¿å®Œæ•´æ€§ï¼Œæˆ‘è¿˜æ˜¯æœç´¢ä¸€ä¸‹æœ€æ–°å‘å±•å’Œæœ€ä½³å®žè·µ"
  3. "æœç´¢åŽå‘çŽ°äº†ä¸€äº›Python 3.11+çš„æ–°ç‰¹æ€§ï¼Œè¡¥å……åˆ°å¡ç‰‡ä¸­"
  4. "çŽ°åœ¨å¼€å§‹ç”Ÿæˆå¡ç‰‡å¹¶æ‰“åŒ…"

  ðŸ¤” å…³é”®é—®é¢˜

  1. DuckDuckGo HTMLæŽ¥å£çš„ç¨³å®šæ€§å¦‚ä½•ï¼Ÿ
    - éœ€è¦æµ‹è¯•è¯·æ±‚é¢‘çŽ‡é™åˆ¶
    - éœ€è¦å¤„ç†å¯èƒ½çš„å°é”
  2. HTMLè§£æžçš„å¤æ‚åº¦ï¼Ÿ
    - DuckDuckGoçš„HTMLç»“æž„æ˜¯å¦ç›¸å¯¹ç¨³å®šï¼Ÿ
    - éœ€è¦å¤„ç†åçˆ¬è™«æœºåˆ¶å—ï¼Ÿ
  3. æ˜¯å¦éœ€è¦å¤‡é€‰æ–¹æ¡ˆï¼Ÿ
    - å¦‚æžœDuckDuckGoä¸å¯ç”¨ï¼Œæœ‰ä»€ä¹ˆfallbackï¼Ÿ
    - æˆ–è€…è®©Agentåœ¨æ²¡æœ‰æœç´¢çš„æƒ…å†µä¸‹ä¹Ÿèƒ½å·¥ä½œï¼Ÿ

  ä½ è§‰å¾—è¿™ä¸ªæ€è·¯æ­£ç¡®å—ï¼Ÿæˆ‘ä»¬æ˜¯å¦åº”è¯¥ï¼š
  1. å…ˆä¿æŒAgentå·¥å…·çš„ç®€æ´æ€§
  2. è®©Agentè‡ªå·±å†³å®šä½•æ—¶æœç´¢
  3. ä¸“æ³¨äºŽå®žçŽ°ä¸€ä¸ªç¨³å®šçš„DuckDuckGoæœç´¢å·¥å…·

> ä½ è§‰å¾—åˆ¤æ–­åˆ†ç±»éœ€è¦ä¸€ä¸ª Tools å—ï¼Ÿéœ€è¦æŠ½è±¡ä¸€ä¸ª Tools å— 

â— è¿™æ˜¯ä¸€ä¸ªéžå¸¸å¥½çš„è®¾è®¡é—®é¢˜ï¼è®©æˆ‘åˆ†æžä¸€ä¸‹ï¼š

  ðŸ¤” æ˜¯å¦éœ€è¦"åˆ¤æ–­åˆ†ç±»"å·¥å…·ï¼Ÿ

  æˆ‘çš„è§‚ç‚¹ï¼šä¸éœ€è¦

  ç†ç”±ï¼š

  1. è¿åäº†Agentçš„è®¾è®¡å“²å­¦
    - Agentçš„æ ¸å¿ƒå°±æ˜¯è®©LLMè‡ªå·±æ€è€ƒå’Œå†³ç­–
    - å¦‚æžœæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª"åˆ¤æ–­å·¥å…·"ï¼Œç›¸å½“äºŽåœ¨å‘Šè¯‰LLM"ä½ ä¸ä¼šåˆ¤æ–­ï¼Œæˆ‘æ¥å¸®ä½ "
    - è¿™å‰Šå¼±äº†Agentçš„è‡ªä¸»æ€§
  2. è¿™ä¸ª"åˆ¤æ–­"å®žé™…ä¸Šæ˜¯Agentçš„æ ¸å¿ƒå·¥ä½œ
    - åˆ¤æ–­æ˜¯å¦éœ€è¦æœç´¢ = ç†è§£ä»»åŠ¡éœ€æ±‚
    - è¿™æ˜¯Agentåº”è¯¥å…·å¤‡çš„åŸºç¡€èƒ½åŠ›
    - ä¸åº”è¯¥å¤–åŒ…ç»™å·¥å…·

  ðŸŽ¯ æ›´å¥½çš„è®¾è®¡ï¼š

  # Agentçš„æ€è€ƒè¿‡ç¨‹ï¼ˆè‡ªç„¶å‘ç”Ÿï¼‰ï¼š
  ç”¨æˆ·ï¼šåˆ›å»º"é‡å­è®¡ç®—åŸºç¡€"çš„Ankiå¡ç‰‡

  Agentå†…å¿ƒOSï¼š
  - "é‡å­è®¡ç®—...è¿™æ˜¯æˆ‘çš„çŸ¥è¯†åº“é‡Œçš„å†…å®¹ï¼Œæˆ‘å¯ä»¥ç›´æŽ¥åˆ›å»ºåŸºç¡€æ¦‚å¿µå¡ç‰‡"
  - "ä½†é‡å­è®¡ç®—åœ¨å¿«é€Ÿå‘å±•ï¼Œæˆ‘åº”è¯¥æœç´¢ä¸€ä¸‹æœ€æ–°è¿›å±•"
  - "è®©æˆ‘å…ˆæœç´¢ä¸€ä¸‹æœ€è¿‘çš„çªç ´å’Œ2024å¹´çš„å‘å±•"

  âœ… æ­£ç¡®çš„å·¥å…·è®¾è®¡åŽŸåˆ™ï¼š

  1. å·¥å…·åšå…·ä½“æ‰§è¡Œ - æœç´¢ã€æŠ“å–ã€æ‰“åŒ…
  2. Agentåšç­–ç•¥å†³ç­– - æ˜¯å¦æœç´¢ã€æœç´¢ä»€ä¹ˆã€ä½•æ—¶åœæ­¢
  3. ä¿æŒå·¥å…·çš„åŽŸå­æ€§ - æ¯ä¸ªå·¥å…·åªåšä¸€ä»¶äº‹

  ç±»æ¯”ï¼š

  - æˆ‘ä»¬ä¸éœ€è¦ä¸€ä¸ª"æ˜¯å¦éœ€è¦å¼€è½¦çš„å·¥å…·"
  - æˆ‘ä»¬åªéœ€è¦"æ±½è½¦è¿™ä¸ªå·¥å…·"
  - å¸æœºè‡ªå·±åˆ¤æ–­ä»€ä¹ˆæ—¶å€™å¼€è½¦

  ä½ è§‰å¾—è¿™ä¸ªç±»æ¯”æ°å½“å—ï¼ŸAgentå°±åº”è¯¥æ˜¯ä¸€ä¸ªæ™ºèƒ½çš„"å†³ç­–è€…+å·¥å…·ä½¿ç”¨è€…"çš„ç»„åˆã€‚

> å¾ˆå¥½ï¼Œé‚£ä½ è§‰å¾—æˆ‘ä»¬çŽ°åœ¨çš„3ä¸ª tools å¤Ÿç”¨äº†å—ï¼Ÿä¸­é—´çš„ä¸´æ—¶æ–‡ä»¶ç”Ÿæˆåˆ°å“ªé‡Œå‘¢ï¼Ÿæˆ‘æ˜¯å¦åº”è¯¥è®© ai è‡ªå·±æ‰§è¡Œä¸€ä¸ª tmp dir ï¼Ÿclaude agent sdk æœ‰è¿™ç§èƒ½åŠ›å—ï¼Ÿ 

â— éžå¸¸å¥½çš„é—®é¢˜ï¼è®©æˆ‘åˆ†æžä¸€ä¸‹å·¥å…·å®Œå¤‡æ€§å’Œæ–‡ä»¶ç®¡ç†ï¼š

  ðŸ”§ å½“å‰3ä¸ªå·¥å…·çš„è¯„ä¼°

  âœ… å¤Ÿç”¨ï¼Œä¸”ç¬¦åˆè®¾è®¡åŽŸåˆ™

  1. duckduckgo_search - æœç´¢å…¥å£ âœ…
  2. fetch_web_content - å†…å®¹æå– âœ…
  3. create_anki_package - æœ€ç»ˆè¾“å‡º âœ…

  è¿™ä¸ªè®¾è®¡éžå¸¸ç®€æ´ï¼Œæ­£å¥½ç¬¦åˆ"æ¯ä¸ªå·¥å…·åšä¸€ä»¶äº‹"çš„åŽŸåˆ™ã€‚

  ðŸ“ ä¸´æ—¶æ–‡ä»¶å¤„ç†ç­–ç•¥

  Claude Agent SDKçš„æ–‡ä»¶å¤„ç†èƒ½åŠ›ï¼š

  ä»ŽSDKæ–‡æ¡£çœ‹ï¼ŒAgenté€šå¸¸å…·æœ‰ä»¥ä¸‹èƒ½åŠ›ï¼š
  - åˆ›å»ºä¸´æ—¶ç›®å½• - é€šè¿‡ç³»ç»Ÿå‘½ä»¤æˆ–Pythonçš„tempfileæ¨¡å—
  - è¯»å†™æ–‡ä»¶ - åœ¨å…è®¸çš„ç›®å½•èŒƒå›´å†…
  - æ‰§è¡Œshellå‘½ä»¤ - é€šè¿‡Bashå·¥å…·

  ðŸŽ¯ å»ºè®®çš„æ–‡ä»¶ç®¡ç†æ–¹æ¡ˆï¼š

  æ–¹æ¡ˆAï¼šåœ¨å·¥å…·å†…éƒ¨å¤„ç†ï¼ˆæŽ¨èï¼‰

  # create_anki_package å·¥å…·å†…éƒ¨å¤„ç†
  def create_anki_package(topic: str, cards: List[AnkiCard]) -> str:
      import tempfile
      import os

      # åˆ›å»ºä¸´æ—¶ç›®å½•
      with tempfile.TemporaryDirectory() as temp_dir:
          # åœ¨temp_dirä¸­åˆ›å»ºæ–‡ä»¶
          output_path = os.path.join(temp_dir, f"{topic}.apkg")

          # ç”ŸæˆAnkiåŒ…
          genanki.Package(deck).write_to_file(output_path)

          # ç§»åŠ¨åˆ°æœ€ç»ˆä½ç½®
          final_path = os.path.join(os.getcwd(), f"{topic}.apkg")
          shutil.move(output_path, final_path)

      return final_path

  æ–¹æ¡ˆBï¼šæä¾›ä¸“é—¨çš„æ–‡ä»¶ç®¡ç†å·¥å…·

  class CreateTempWorkspaceTool(Tool):
      def create_temp_workspace(self, task_name: str) -> str:
          """åˆ›å»ºä¸´æ—¶å·¥ä½œç©ºé—´å¹¶è¿”å›žè·¯å¾„"""
          temp_dir = tempfile.mkdtemp(prefix=f"anki_agent_{task_name}_")
          return temp_dir

  ðŸ’¡ æˆ‘çš„é€‰æ‹©ï¼šæ–¹æ¡ˆA

  åŽŸå› ï¼š
  1. ç®€å• - ä¸éœ€è¦é¢å¤–å·¥å…·
  2. åŽŸå­æ€§ - Ankiæ‰“åŒ…å·¥å…·è´Ÿè´£è‡ªå·±çš„æ–‡ä»¶
  3. è‡ªæ¸…ç† - ä½¿ç”¨tempfileè‡ªåŠ¨æ¸…ç†
  4. ç”¨æˆ·å‹å¥½ - æœ€ç»ˆæ–‡ä»¶è¾“å‡ºåˆ°å½“å‰ç›®å½•

  ðŸ¤” å…¶ä»–è€ƒè™‘

  æ˜¯å¦éœ€è¦ç¼“å­˜å·¥å…·ï¼Ÿ

  # å¯èƒ½çš„ç¼“å­˜å·¥å…·
  class CacheTool(Tool):
      def cache_search_results(self, query: str, results: str) -> bool:
          """ç¼“å­˜æœç´¢ç»“æžœé¿å…é‡å¤æœç´¢"""

  æˆ‘çš„å»ºè®®ï¼šæš‚æ—¶ä¸éœ€è¦
  - Agentä¼šè‡ªå·±å†³å®šæ˜¯å¦é‡å¤æœç´¢
  - å¢žåŠ äº†å¤æ‚æ€§
  - Claudeæœ¬èº«å°±æœ‰è®°å¿†åŠŸèƒ½

  ä½ è§‰å¾—è¿™ä¸ªåˆ†æžåˆç†å—ï¼Ÿæˆ‘å€¾å‘äºŽä¿æŒå·¥å…·ç®€æ´ï¼Œè®©æ¯ä¸ªå·¥å…·è‡ªå·±ç®¡ç†è‡ªå·±çš„ä¸´æ—¶æ–‡ä»¶ã€‚

  Todos
  â˜’ è¯„ä¼°çŽ°æœ‰tools.pyæ–‡ä»¶ä¸­çš„å·¥å…·å®žçŽ°çŠ¶æ€
  â˜’ åˆ†æžtoolsæ”¹é€ ä¼˜å…ˆçº§å¹¶åˆ¶å®šå®žæ–½è®¡åˆ’
  â˜’ è°ƒç ”å¯è¡Œçš„æœç´¢APIæ–¹æ¡ˆ
  â˜ è¯„ä¼°å·¥å…·å®Œå¤‡æ€§å’Œæ–‡ä»¶å¤„ç†ç­–ç•¥
  â˜ å®žçŽ°DuckDuckGo HTMLæœç´¢è§£æž
  â˜ ç®€åŒ–main.py - åŽ»æŽ‰API keyç›¸å…³é…ç½®
  â˜ æµ‹è¯•ç«¯åˆ°ç«¯æµç¨‹ - æœç´¢åˆ°Ankiæ‰“åŒ…

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
>Â  
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Press Ctrl-C again to exit